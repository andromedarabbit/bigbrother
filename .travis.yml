dist: trusty

language: go

go:
  - 1.8.x

cache:
  directories:
    - ${TRAVIS_BUILD_DIR}/vendor

services:
  - docker

install:
  - curl https://glide.sh/get | sh

before_script:
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";

script:
  - make test

after_success:
  - if [ -n "$TRAVIS_TAG" ]; then
    make TAG=${TRAVIS_TAG} deploy;
    fi
  - make TAG=latest deploy
  - make TAG=${TRAVIS_COMMIT} deploy
  - bash <(curl -s https://codecov.io/bash)

notifications:
  slack:
    secure: GWUo5m17rCkhyiu01HgETGLFePgFe4qN3HD3mLhEPhBA5LOa2yOgSMXrrI+aueqyeLQze05qE75Uq51pHZap1rj5yaGDUDSuO9XmhvTuFBpmq9Joy/4egVFGjG4eoXhXwDT/M8D4fzHocOjxqHPHW7ZZIJQpOLQDIzE2GkIii9kO10XQiQs2JRKc7iE83WPO/IOxtJ29HIx9xizL2pjfAnJkcl3VlX7p+AmIcXJrASnQZZlMlQI5PeP0Uo56Zeh/BfOfyEvYILNHZcQrlZjj4n1KnmFdYqAZahQwnUzGtl+gBoYSPn0zlmJcJsWuw/WXTrlDla3YGhwRkRIWgBVGtKQTFCZ3K9VS0RnI7E7Bjx9vjDuLq/94B1dvsMbI9LtEvSvE6KLOlMmwBs5OO+76GlBRBrEjRLgwJ+AHqUEs/9gfsCi3VANVqFNPm6kz4TCEn0iaZ95WYfOS7RlvCKfMdbd1+1rWLl8SJ3Aty8WfjGGzh5wYw+6tWeDT+qh3dmGDDdXSElmU6zUB360qtQZvpRIzFaRFD2ycN4A8POS4IYHnw2P0VqpUzJD84ciU4M/IYCB/nH5HGNyN0GScZCSvvEqDtu/Cr/zRv7+qdM2JUKnivhe6Q6tzEYLAncdX2gmux9wWI7N68Ijxu92WwFIVPU4bMjWTAxUFlruZ6zF9FMs=
